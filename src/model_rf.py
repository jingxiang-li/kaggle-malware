def train_rf(ftr_index, random_state):

    from sklearn.ensemble import RandomForestClassifier
    from data_split import get_data
    import pickle
    from sklearn import metrics
    import numpy as np

    # with open('../data/ftr_index.pickle', 'rb') as f_in:
    #     ftr_index = pickle.load(f_in)

    X_train, y_train, X_test, y_test = get_data(ftr_index, random_state)

    clf = RandomForestClassifier(n_estimators=1000, verbose=0)
    clf.fit(X_train, y_train)

    y_pred_prob = clf.predict_proba(X_test)
    y_pred_labels = np.argmax(y_pred_prob, axis=1)

    logloss = metrics.log_loss(y_test, y_pred_prob)
    acc = metrics.accuracy_score(y_test, y_pred_labels)
    precision, recall, fscore, support = metrics.precision_recall_fscore_support(
        y_test, y_pred_labels)

    result_list = []
    result_list.append(logloss)
    result_list.append(acc)
    for i in range(8):
        result_list.append(recall[i])
        result_list.append(precision[i])
        result_list.append(fscore[i])

    return result_list
