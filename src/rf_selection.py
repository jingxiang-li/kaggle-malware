def get_ftr_index(random_state):
    from data_split import get_data

    def select_k_best(k, X, y):
        from heapq import nlargest
        from sklearn.ensemble import ExtraTreesClassifier
        clf = ExtraTreesClassifier(
            n_estimators=1000,
            criterion='gini',
            n_jobs=-1,
            class_weight='balanced_subsample',
            verbose=1)
        clf.fit(X, y)
        score = clf.feature_importances_
        index = nlargest(k, range(len(score)), score.take)
        return index

    X_train, y_train, X_test, y_test = get_data(random_state=random_state)
    ftr_index = select_k_best(500, X_train, y_train)
    return ftr_index

# with open('../data/ftr_index.pickle', 'wb') as f_out:
#     pickle.dump(ftr_index, f_out)
