from rf_selection import get_ftr_index

from sklearn.ensemble import ExtraTreesClassifier
from data_split import get_data
import pickle
from sklearn import metrics
import numpy as np

# with open('../data/ftr_index.pickle', 'rb') as f_in:
#     ftr_index = pickle.load(f_in)


random_state = 0
ftr_index = get_ftr_index(random_state)
X_train, y_train, X_test, y_test = get_data(ftr_index, random_state)

clf = ExtraTreesClassifier(n_estimators=1000, verbose=0)
clf.fit(X_train, y_train)

y_pred_prob = clf.predict_proba(X_test)
y_pred_labels = np.argmax(y_pred_prob, axis=1)

logloss = metrics.log_loss(y_test, y_pred_prob)
acc = metrics.accuracy_score(y_test, y_pred_labels)
print(metrics.confusion_matrix(y_test, y_pred_labels))
print(metrics.classification_report(y_test, y_pred_labels))
