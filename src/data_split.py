def get_splits(random_state):
    from sklearn.cross_validation import StratifiedShuffleSplit
    import pickle

    with open('../data/y_all.pickle', 'rb') as f_in:
        y = pickle.load(f_in)

    sss = StratifiedShuffleSplit(
        y, n_iter=1, test_size=0.95, random_state=random_state)
    splits = list(sss)[0]

    train_index, test_index = splits[0], splits[1]
    return train_index, test_index


def get_data(ftr_index=None, random_state=0):
    import pickle
    import numpy as np
    with open('../data/X_all.pickle', 'rb') as f_in:
        X_all = pickle.load(f_in)
    with open('../data/y_all.pickle', 'rb') as f_in:
        y_all = np.array(pickle.load(f_in))

    train_index, test_index = get_splits(random_state)

    X_train, y_train = X_all[train_index, :], y_all[train_index]
    X_test, y_test = X_all[test_index, :], y_all[test_index]

    if ftr_index is not None:
        X_train = X_train[:, ftr_index]
        X_test = X_test[:, ftr_index]

    return X_train, y_train, X_test, y_test


X_train, y_train, X_test, y_test = get_data()
print(X_train.shape)
print(X_test.shape)
