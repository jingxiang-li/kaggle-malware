import re
from os import listdir, path
import pickle
from collections import Counter

wd = '/media/s_ariel/HDD_1T/Kaggle/data/train'

files = listdir(wd)
regex_asm = re.compile(r'.*\.asm')
asm_files = [f for f in files if regex_asm.match(f) is not None]
asm_files.sort()

seg_list = []
for asm in asm_files:
    print(asm)
    segs = []
    with open(path.join(wd, asm), 'r', encoding='latin-1') as f_in:
        for line in f_in:
            seg = line.split(':')[0]
            segs.append(seg)
        seg_list.append(Counter(segs))

path_out = '/home/s_ariel/Documents/seg_counter.pickle'
with open(path_out, 'wb') as f_out:
    pickle.dump(seg_list, f_out)
