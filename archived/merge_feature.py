from os import listdir, path
import pickle
import numpy as np


wd = '/home/s_ariel/Documents/data'
data_files = listdir(wd)

data_list = []

for data_file in data_files:
    if data_file == 'merged.pickle':
        continue
    with open(path.join(wd, data_file), 'rb') as f_in:
        data = pickle.load(f_in)
    if hasattr(data, 'toarray') is True:
        data = data.toarray()
    print(data.dtype)
    data_list.append(data)

data_merged = np.float32(np.hstack(data_list))
print(data_merged.dtype)
save_file = 'data/merged.pickle'
with open(save_file, 'wb') as f_out:
    pickle.dump(data_merged, f_out)
