rm(list = ls())

require(dplyr)
require(pipeR)
require(ggplot2)

setwd('~/Thesis/slideImgs/')
source("ggplot_theme.R")

# new malwares trend
x = c(24, 26, 40, 60, 61, 117, 283, 482, 486, 299)
ratio = 140000000 / 472
year = 2007:2016

df = data.frame(y = x * ratio, year = 2007:2016)
df$year = as.factor(df$year)

fancy_scientific <- function(l) {
  l <- format(l, scientific = FALSE)
  l <- substr(l, 1, 3)
  l <- paste(l, 'M', sep="")
  l[1] <- "0M"
  l
}

cairo_pdf("./new-malware.pdf", width = 7, height = 5.25)
df %>>%
  ggplot(aes(year, y)) +
  geom_bar(stat = 'identity', width = .8) +
  ylab('') +
  xlab('') + 
  ggtitle('Number of New Malwares Registered in the Last 10 Years') +
  theme_Publication() +
  scale_fill_Publication() + 
    scale_y_continuous(labels = fancy_scientific, limits = c(0, 1.5e+08))
dev.off()


area <- c(439, 832, 1456, 2236, 3018, 4681, 8632, 14995, 21990, 26157)
x <- area / 53
ratio = 600000000 / 542

df = data.frame(y = x * ratio, year = 2007:2016)
df$year = as.factor(df$year)

cairo_pdf("./sum-malware.pdf", width = 7, height = 5.25)
df %>>%
  ggplot(aes(year, y)) +
  geom_bar(stat = 'identity', width = .8) +
  ylab('') +
  xlab('') + 
  ggtitle('Total Number of Malwares Registered in the Last 10 Years') +
  theme_Publication() +
  scale_fill_Publication() + 
  scale_y_continuous(labels = fancy_scientific, limits=c(0, 6e+08))
dev.off()

